<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Extension Debug Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 20px auto;
            padding: 20px;
        }
        .test-section {
            background: #f5f5f5;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .smiles {
            background: #fff;
            padding: 10px;
            border: 2px solid #007bff;
            border-radius: 4px;
            display: inline-block;
            font-family: monospace;
            font-size: 16px;
            margin: 10px 0;
        }
        .instructions {
            background: #fff3cd;
            border: 1px solid #ffc107;
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
        }
        .instructions h3 {
            margin-top: 0;
            color: #856404;
        }
        .instructions ol {
            margin: 10px 0;
            padding-left: 25px;
        }
        .instructions li {
            margin: 8px 0;
        }
        code {
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª Extension Options Debug Test</h1>
    
    <div class="instructions">
        <h3>ğŸ“‹ Instructions:</h3>
        <ol>
            <li><strong>Reload the extension</strong>: Go to <code>chrome://extensions</code> â†’ Click RELOAD on "Chemistry Formula Renderer"</li>
            <li><strong>Open extension popup</strong>: Click the extension icon</li>
            <li><strong>Select MoleculeViewer</strong> renderer (top radio button)</li>
            <li><strong>Enable "Aromatic Circles"</strong> option (should save automatically)</li>
            <li><strong>Open DevTools</strong>: Press <code>F12</code></li>
            <li><strong>Go to Console tab</strong></li>
            <li><strong>Reload THIS page</strong>: Press <code>F5</code></li>
            <li><strong>Check the console output</strong> - look for:
                <ul>
                    <li>ğŸ§ª Using MOLECULEVIEWER renderer engine</li>
                    <li>âš™ï¸ Rendering Options: {aromaticCircles: true, ...}</li>
                    <li>API URL: http://localhost:5000/img/smiles?...&aromatic_circles=true&...</li>
                    <li>ğŸ“ Cache URL: ...aromatic_circles_...</li>
                </ul>
            </li>
        </ol>
    </div>

    <div class="test-section">
        <h2>Test 1: Benzene (Aromatic)</h2>
        <p>SMILES: <span class="smiles">c1ccccc1</span></p>
        <p><strong>Expected with "Aromatic Circles" ON:</strong> Should show a circle inside the ring instead of alternating double bonds</p>
        <p><strong>Expected with "Aromatic Circles" OFF:</strong> Should show alternating single/double bonds</p>
    </div>

    <div class="test-section">
        <h2>Test 2: Propane (Aliphatic)</h2>
        <p>SMILES: <span class="smiles">CCC</span></p>
        <p><strong>Expected with "Show Methyls" ON:</strong> Should show CHâ‚ƒ labels on the ends</p>
        <p><strong>Expected with "Show Methyls" OFF:</strong> Just shows C-C-C line structure</p>
    </div>

    <div class="test-section">
        <h2>Test 3: Ethanol (Functional Group)</h2>
        <p>SMILES: <span class="smiles">CCO</span></p>
        <p><strong>Expected with "Show Carbons" ON:</strong> Should show C labels on carbon atoms</p>
        <p><strong>Expected with "Show Carbons" OFF:</strong> Carbons implicit, only OH shown</p>
    </div>

    <div class="test-section">
        <h2>Test 4: Toluene (Aromatic with Methyl)</h2>
        <p>SMILES: <span class="smiles">Cc1ccccc1</span></p>
        <p><strong>Expected with "Aromatic Circles" + "Show Methyls":</strong> Circle in ring + CHâ‚ƒ label</p>
    </div>

    <h2>ğŸ” What to Look For in Console:</h2>
    
    <pre style="background: #f8f9fa; padding: 15px; border-radius: 4px; overflow-x: auto;">
<span style="color: #0088FF;">ğŸ§ª Using MOLECULEVIEWER renderer engine</span>
<span style="color: #FF6B00;">ğŸ“¤ Using SMILES endpoint</span>
<span style="color: #FF6B00;">âš™ï¸ Rendering Options:</span> {
  showCarbons: false,
  showMethyls: false,
  aromaticCircles: <span style="color: red; font-weight: bold;">true</span>,  â† Should match your popup settings!
  fancyBonds: true,
  atomNumbers: false,
  flipHorizontal: false,
  flipVertical: false,
  hydrogensMode: "keep"
}
API URL: http://localhost:5000/img/smiles?smiles=c1ccccc1&width=300&height=200&json=true&show_carbons=false&show_methyls=false&<span style="color: red; font-weight: bold;">aromatic_circles=true</span>&...
<span style="color: #00AAFF;">ğŸŒ Fetching from backend...</span>
<span style="color: #00FF00;">âœ… Got response from backend:</span>
<span style="color: #FFAA00;">ğŸ“Š Backend data:</span> {success: true, smiles: "c1ccccc1", cache_url: "..."}
<span style="color: green;">âœ… Image loaded successfully</span>
<span style="color: #0066cc;">ğŸ“ Cache URL:</span> http://localhost:5000/cache/smiles_c1ccccc1_<span style="color: red; font-weight: bold;">aromatic_circles</span>_xyz.svg
    </pre>

    <h2>âŒ Troubleshooting:</h2>
    <ul>
        <li><strong>No console logs at all?</strong>
            <ul>
                <li>Extension not loaded or disabled</li>
                <li>Check <code>chrome://extensions</code></li>
            </ul>
        </li>
        <li><strong>Options show all false?</strong>
            <ul>
                <li>Settings not saving - check extension popup</li>
                <li>Try toggling options off and on again</li>
                <li>Check Application â†’ Storage â†’ chrome.storage.sync in DevTools</li>
            </ul>
        </li>
        <li><strong>API URL missing options parameters?</strong>
            <ul>
                <li>Extension using old code - RELOAD extension!</li>
                <li>Go to chrome://extensions â†’ click RELOAD</li>
            </ul>
        </li>
        <li><strong>Cache URL doesn't include option names?</strong>
            <ul>
                <li>Backend using old code - restart Flask server</li>
                <li>Clear Python cache: <code>rm MoleculeViewer/app/__pycache__/* -Force</code></li>
            </ul>
        </li>
    </ul>

    <script>
        // Log to help debug
        console.log('%câ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'color: #007bff; font-weight: bold;');
        console.log('%cğŸ§ª Extension Debug Test Page Loaded', 'color: #007bff; font-weight: bold; font-size: 16px;');
        console.log('%câ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'color: #007bff; font-weight: bold;');
        console.log('%cWaiting for extension to process SMILES formulas...', 'color: #666;');
        console.log('%cIf you see no extension logs below, the extension may not be loaded or enabled.', 'color: #ff6600;');
        console.log('%câ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'color: #007bff; font-weight: bold;');
    </script>
</body>
</html>
