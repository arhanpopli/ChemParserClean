<!DOCTYPE html>
<html>
<head>
    <title>Test Dark Mode for mol2chemfig SVG</title>
    <style>
        body {
            background: #000;
            color: #fff;
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            background: #111;
            border: 1px solid #333;
        }
        h2 {
            color: #4CAF50;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>mol2chemfig Dark Mode Test</h1>

        <div class="test-section">
            <h2>Original SVG (should be black, invisible on dark background)</h2>
            <div id="original-svg"></div>
        </div>

        <div class="test-section">
            <h2>Dark Mode SVG (should be white, visible on dark background)</h2>
            <div id="darkmode-svg"></div>
        </div>

        <div class="test-section">
            <h2>Test Results</h2>
            <pre id="test-results"></pre>
        </div>
    </div>

    <script>
        // Fetch SVG from mol2chemfig backend
        fetch('http://localhost:8000/m2cf/submit', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ textAreaData: 'CCO' })
        })
        .then(response => response.json())
        .then(data => {
            const originalSvg = data.svglink;

            // Display original SVG
            document.getElementById('original-svg').innerHTML = originalSvg;

            // Apply dark mode transformation
            const darkModeSvg = originalSvg
                .replace(/#000000/gi, '#FFFFFF')
                .replace(/#000\b/gi, '#FFF')
                .replace(/rgb\(0,\s*0,\s*0\)/gi, 'rgb(255, 255, 255)')
                .replace(/stroke="black"/gi, 'stroke="white"')
                .replace(/stroke='black'/gi, "stroke='white'")
                .replace(/fill="black"/gi, 'fill="white"')
                .replace(/fill='black'/gi, "fill='white'");

            // Display dark mode SVG
            document.getElementById('darkmode-svg').innerHTML = darkModeSvg;

            // Show test results
            const results = [];
            results.push('Original SVG length: ' + originalSvg.length);
            results.push('Dark mode SVG length: ' + darkModeSvg.length);
            results.push('');
            results.push('Colors found in original:');
            results.push('  #000000 matches: ' + (originalSvg.match(/#000000/gi) || []).length);
            results.push('  #000 matches: ' + (originalSvg.match(/#000\b/gi) || []).length);
            results.push('  stroke="black" matches: ' + (originalSvg.match(/stroke="black"/gi) || []).length);
            results.push('  stroke=\'black\' matches: ' + (originalSvg.match(/stroke='black'/gi) || []).length);
            results.push('');
            results.push('Colors found in dark mode SVG:');
            results.push('  #FFFFFF matches: ' + (darkModeSvg.match(/#FFFFFF/gi) || []).length);
            results.push('  #FFF matches: ' + (darkModeSvg.match(/#FFF/gi) || []).length);
            results.push('  stroke="white" matches: ' + (darkModeSvg.match(/stroke="white"/gi) || []).length);
            results.push('  stroke=\'white\' matches: ' + (darkModeSvg.match(/stroke='white'/gi) || []).length);

            document.getElementById('test-results').textContent = results.join('\n');
        })
        .catch(error => {
            document.getElementById('test-results').textContent = 'Error: ' + error.message;
        });
    </script>
</body>
</html>
