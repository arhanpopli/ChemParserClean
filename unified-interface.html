<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuintessenLabs | Professional Suite</title>
    <link rel="stylesheet" href="quintessen-v2.css">
    <!-- 3Dmol.js -->
    <script src="https://3dmol.org/build/3Dmol-min.js"></script>
    <script src="advanced_molviewer_3dmol.js"></script>
</head>

<body>
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="brand">
            <div class="brand-logo">QuintessenLabs</div>
            <div class="brand-tagline">Advanced Chemical Intelligence</div>
        </div>

        <nav class="nav-links">
            <a class="nav-item active" onclick="switchTab('flow')">
                <span class="nav-icon">üîÑ</span>
                <span>System Architecture</span>
            </a>
            <a class="nav-item" onclick="switchTab('mol2chemfig')">
                <span class="nav-icon">üìê</span>
                <span>Mol2ChemFig</span>
            </a>
            <a class="nav-item" onclick="switchTab('moleculeviewer')">
                <span class="nav-icon">üß¨</span>
                <span>MoleculeViewer</span>
            </a>
            <a class="nav-item" onclick="switchTab('pubchem')">
                <span class="nav-icon">üåê</span>
                <span>PubChem Fetcher</span>
            </a>
            <a class="nav-item" onclick="switchTab('molview')">
                <span class="nav-icon">üîÆ</span>
                <span>QLabs - MolView</span>
            </a>
            <a class="nav-item" onclick="switchTab('smilesdrawer')">
                <span class="nav-icon">‚úèÔ∏è</span>
                <span>QLabs - SmilesDrawer</span>
            </a>
            <a class="nav-item" onclick="switchTab('3d-smiles')">
                <span class="nav-icon">üî¨</span>
                <span>3D SMILES</span>
            </a>
            <a class="nav-item" onclick="switchTab('tests')">
                <span class="nav-icon">üß™</span>
                <span>System Tests</span>
            </a>
            <a class="nav-item" onclick="switchTab('designs')">
                <span class="nav-icon">üé®</span>
                <span>Design Gallery</span>
            </a>
            <a class="nav-item" onclick="switchTab('control')">
                <span class="nav-icon">üéÆ</span>
                <span>Control Panel</span>
            </a>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <header class="header">
            <h1 class="page-title" id="page-title">System Architecture</h1>
            <div class="status-badge">
                <div class="status-dot"></div>
                <span>System Online</span>
            </div>
        </header>

        <div class="content-area">

            <!-- Flow Tab -->
            <div id="flow" class="tab-pane active">
                <div class="card">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                        <div>
                            <h2 class="section-title">Data Flow Visualization</h2>
                            <p class="section-desc">Real-time visualization of chemical data processing pipelines.</p>
                        </div>
                        <button class="btn btn-secondary" onclick="checkAllServers()">Refresh Status</button>
                    </div>

                    <div id="flow-diagram" style="position: relative; width: 100%; height: 700px; overflow: hidden;">
                        <svg id="flow-connections"
                            style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;"></svg>

                        <!-- Nodes -->
                        <div class="flow-node draggable" id="node-page"
                            style="position: absolute; left: 50px; top: 80px; padding: 1rem; border-radius: 12px; color: #1F2937;">
                            <div style="font-size: 1.5rem;">üìÑ</div>
                            <div style="font-weight: 700;">Web Page</div>
                        </div>

                        <div class="flow-node draggable" id="node-extension"
                            style="position: absolute; left: 250px; top: 150px; padding: 1rem; border-radius: 12px; color: #1F2937;">
                            <div style="font-size: 1.5rem;">üß©</div>
                            <div style="font-weight: 700;">Extension</div>
                        </div>

                        <div class="flow-node draggable" id="node-moleculeviewer"
                            style="position: absolute; left: 750px; top: 420px; padding: 1rem; border-radius: 12px; color: #1F2937;">
                            <div style="font-size: 1.5rem;">üß¨</div>
                            <div style="font-weight: 700;">MoleculeViewer</div>
                            <div id="status-moleculeviewer" style="font-size: 0.8rem; margin-top: 4px;">Checking...
                            </div>
                        </div>

                        <div class="flow-node draggable" id="node-mol2chemfig"
                            style="position: absolute; left: 950px; top: 420px; padding: 1rem; border-radius: 12px; color: #1F2937;">
                            <div style="font-size: 1.5rem;">üìê</div>
                            <div style="font-weight: 700;">Mol2ChemFig</div>
                            <div id="status-mol2chemfig" style="font-size: 0.8rem; margin-top: 4px;">Checking...</div>
                        </div>

                        <div class="flow-node draggable" id="node-pubchem-local"
                            style="position: absolute; left: 1150px; top: 420px; padding: 1rem; border-radius: 12px; color: #1F2937;">
                            <div style="font-size: 1.5rem;">üåê</div>
                            <div style="font-weight: 700;">PubChem</div>
                            <div id="status-pubchem" style="font-size: 0.8rem; margin-top: 4px;">Checking...</div>
                        </div>

                        <div class="flow-node draggable" id="node-docker"
                            style="position: absolute; left: 950px; top: 550px; padding: 1rem; border-radius: 12px; color: #1F2937;">
                            <div style="font-size: 1.5rem;">üê≥</div>
                            <div style="font-weight: 700;">Docker</div>
                            <div id="status-docker" style="font-size: 0.8rem; margin-top: 4px;">Checking...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mol2ChemFig Tab -->
            <div id="mol2chemfig" class="tab-pane">
                <div class="card">
                    <h2 class="section-title">Mol2ChemFig Generator</h2>
                    <p class="section-desc">Professional LaTeX chemical structure generation.</p>
                    <div class="iframe-wrapper">
                        <iframe src="mol2chemfig-full-interface.html"></iframe>
                    </div>
                </div>
            </div>

            <!-- MoleculeViewer Tab -->
            <div id="moleculeviewer" class="tab-pane">
                <div class="card">
                    <h2 class="section-title">MoleculeViewer</h2>
                    <p class="section-desc">RDKit-based molecular rendering engine.</p>

                    <div class="control-grid">
                        <div class="input-group">
                            <label class="input-label">SMILES String</label>
                            <input type="text" class="input-field" id="mv-smiles" value="CCO">
                        </div>
                        <div class="input-group">
                            <label class="input-label">Dimensions</label>
                            <div style="display: flex; gap: 1rem;">
                                <input type="number" class="input-field" id="mv-width" value="400" placeholder="W">
                                <input type="number" class="input-field" id="mv-height" value="300" placeholder="H">
                            </div>
                        </div>
                    </div>

                    <div style="margin-bottom: 2rem;">
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" id="mv-3d-toggle">
                            <span style="font-weight: 600; color: var(--text-main);">Enable 3D Stereochemistry
                                (OPSIN)</span>
                        </label>
                    </div>

                    <div style="display: flex; gap: 1rem;">
                        <button class="btn btn-primary" onclick="generateMoleculeViewer()">
                            <span>üöÄ</span> Generate Structure
                        </button>
                        <button class="btn btn-secondary" onclick="clearMoleculeViewer()">Clear</button>
                    </div>
                </div>

                <div id="mv-result" class="result-box">
                    <span style="color: var(--text-light);">Visualization will appear here</span>
                </div>
            </div>

            <!-- PubChem Tab -->
            <div id="pubchem" class="tab-pane">
                <div class="card">
                    <h2 class="section-title">PubChem Integration</h2>
                    <div class="control-grid">
                        <div class="input-group">
                            <label class="input-label">Compound Name</label>
                            <input type="text" class="input-field" id="pubchem-name" value="histamine">
                        </div>
                        <div class="input-group">
                            <label class="input-label">Format</label>
                            <select class="input-field" id="pubchem-type">
                                <option value="2d">2D Structure</option>
                                <option value="3d">3D Structure</option>
                            </select>
                        </div>
                    </div>
                    <div style="display: flex; gap: 1rem;">
                        <button class="btn btn-primary" onclick="fetchPubChem()">Fetch Image</button>
                        <button class="btn btn-primary"
                            style="background: linear-gradient(135deg, #10B981 0%, #059669 100%);"
                            onclick="open3DViewer()">Open 3D Viewer</button>
                    </div>
                </div>
                <div id="pubchem-image" class="result-box"></div>
            </div>

            <!-- MolView Tab -->
            <div id="molview" class="tab-pane">
                <div class="card">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                        <h2 class="section-title">QLabs - MolView Modified</h2>
                        <div style="display: flex; gap: 1rem;">
                            <input type="text" class="input-field" id="molview-input" value="CCO"
                                placeholder="SMILES/Name" style="width: 200px;">
                            <button class="btn btn-primary" onclick="loadMolView()">Load</button>
                        </div>
                    </div>
                    <div class="iframe-wrapper">
                        <iframe id="molview-iframe" src="http://localhost:5003/"></iframe>
                    </div>
                </div>
            </div>

            <!-- SmilesDrawer Tab -->
            <div id="smilesdrawer" class="tab-pane">
                <div class="card"
                    style="text-align: center; padding: 6rem 2rem; display: flex; flex-direction: column; align-items: center;">
                    <div
                        style="font-size: 4rem; margin-bottom: 1.5rem; background: var(--primary-fade); width: 100px; height: 100px; display: flex; align-items: center; justify-content: center; border-radius: 50%;">
                        ‚úèÔ∏è</div>
                    <h2 class="section-title" style="color: var(--primary-dark);">QLabs - SmilesDrawer</h2>
                    <p class="section-desc" style="max-width: 500px; margin: 0 auto;">
                        Advanced 2D rendering engine with explicit hydrogen support and carbon labeling.
                        <br><br>
                        <span
                            style="display: inline-block; padding: 0.5rem 1rem; background: #FEF3C7; color: #D97706; border-radius: 20px; font-size: 0.85rem; font-weight: 600;">Coming
                            Soon</span>
                    </p>
                </div>
            </div>

            <!-- 3D SMILES Tab -->
            <div id="3d-smiles" class="tab-pane">
                <div class="card">
                    <h2 class="section-title">OPSIN 3D Generator</h2>
                    <div class="control-grid">
                        <div class="input-group">
                            <label class="input-label">Chemical Name</label>
                            <input type="text" class="input-field" id="opsin-name" value="glucose">
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="generate3DSMILES()">Generate 3D SMILES</button>
                </div>
                <div id="opsin-result" class="result-box"></div>
            </div>

            <!-- Tests Tab -->
            <div id="tests" class="tab-pane">
                <div class="card">
                    <h2 class="section-title">System Verification</h2>
                    <div
                        style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 1rem; margin-top: 2rem;">
                        <button class="btn btn-secondary" onclick="openTest('test_3d_smiles.html')">üß™ 3D SMILES
                            Test</button>
                        <button class="btn btn-secondary" onclick="openTest('test_opsin_3d.html')">üß™ OPSIN
                            Integration</button>
                        <button class="btn btn-secondary" onclick="openTest('test_pubchem_3d.html')">üß™ PubChem
                            3D</button>
                        <button class="btn btn-secondary" onclick="openTest('test_m2cf_full.html')">üß™ Mol2ChemFig
                            Full</button>
                        <button class="btn btn-secondary" onclick="openTest('test_dark_mode.html')">üß™ Dark
                            Mode</button>
                        <button class="btn btn-secondary" onclick="openTest('test_all_features_demo.html')">üß™ All
                            Features Demo</button>
                    </div>
                </div>
            </div>

            <!-- Designs Tab -->
            <div id="designs" class="tab-pane">
                <div class="card">
                    <h2 class="section-title">Design Gallery</h2>
                    <div class="iframe-wrapper">
                        <iframe src="chem-extension/designs/index.html"></iframe>
                    </div>
                </div>
            </div>

            <!-- Control Tab -->
            <div id="control" class="tab-pane">
                <div class="card">
                    <h2 class="section-title">Server Control Panel</h2>
                    <div class="iframe-wrapper">
                        <iframe src="http://localhost:3000/launcher.html"></iframe>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <script src="unified-logic.js"></script>
    <script src="quintessen-v2.js"></script>
</body>

</html>